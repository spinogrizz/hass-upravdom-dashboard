weather:
  entity: weather.openweathermap

  # use emojis to display weather state
  # every emoji is a bit different, so use <span> to tweak their size and position slightly
  custom_fields: 
    weather_icon: >
      [[[
        let time = new Date(entity.attributes.forecast[variables.forecast].datetime)
        let hours = time.getHours()
        let condition = entity.attributes.forecast[variables.forecast].condition

        switch (condition) {

          case 'clear-night':      return "<span style='font-size: 23pt'>ğŸŒ™</span>"
          case 'cloudy':           return "<span style='position: relative; top: -5px'>â˜ï¸</span>"
          case 'exceptional':      return "â­•ï¸"
          case 'fog':              return "ğŸŒ«ï¸"
          case 'hail':             return "ğŸŒ¨ï¸"
          case 'lightning':        return "ğŸŒ©ï¸"
          case 'lightning-rainy':  return "â›ˆï¸"
          case 'partlycloudy':     return (hours < 8 || hours > 20) ? "â˜ï¸" : "â›…ï¸"
          case 'pouring':          return "â˜”"
          case 'rainy':            return "ğŸŒ§ï¸"
          case 'snowy':            return "<span style='font-size: 23pt'>â„ï¸</span>"
          case 'snowy-rainy':      return "ğŸŒ¨ï¸"
          case 'sunny':            return "â˜€ï¸"
          case 'windy':            return "ğŸŒ¬ï¸"
          case 'windy-variant':    return "ğŸŒ¬ï¸"
          default:                 return "â˜ï¸"
        }
      ]]]

  show_icon: false
  show_entity_picture: false
  show_label: true
  show_name: false

  label: >
    [[[
      return parseInt(entity.attributes.forecast[variables.forecast].temperature) + 'Â°'
    ]]]

  styles:
    card:
      # use dynamic background for each cell:
      # darker colorÂ â€”Â at night
      # lighter color â€”Â during the day
      - background: >
          [[[
            let time = new Date(entity.attributes.forecast[variables.forecast].datetime)
            let hours = time.getHours()

            if ( hours > 22 || hours < 7 ) {
              return '#00001155'
            } else if ( hours > 11 && hours < 17 ) {
              return '#E5C04B09'
            } else {
              return 'none'
            }
          ]]]

      - border: none
      - border-radius: 0px
      - width: 105px
      - height: 172px

    label:
      - font-size: 22pt
      - position: absolute
      - bottom: 28px
      - left: 4px
      - width: 100%

    custom_fields:
      weather_icon:
        - font-size: 40px
        - position: absolute
        - top: 35px
        - left: 1px
        - width: 100%
        - filter: grayscale(40%)
 
      